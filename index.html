<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aplicaci√≥n para gesti√≥n de clases particulares con control de pagos y sincronizaci√≥n en la nube">
    <title>Mis Clases - Seguimiento de Estudiantes</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" crossorigin="anonymous">
    
    <!-- Preload JavaScript para mejor rendimiento -->
    <link rel="preload" href="app.js" as="script">
    <link rel="preload" href="github-sync.js" as="script">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1><i class="fas fa-graduation-cap"></i> Mis Clases</h1>
            <div class="header-stats">
                <span class="stat">
                    <i class="fas fa-euro-sign"></i>
                    <span id="total-mes">0</span>
                    <small>‚Ç¨</small>
                </span>
                <span class="stat">
                    <i class="fas fa-calendar-check"></i>
                    <span id="clases-hoy">0</span>
                    <small>clases</small>
                </span>
                <span class="stat">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span id="pagos-pendientes">0</span>
                    <small>pendientes</small>
                </span>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn active" data-view="lista">
                <i class="fas fa-list"></i>
                <span>Lista</span>
            </button>
            <button class="nav-btn" data-view="calendario">
                <i class="fas fa-calendar"></i>
                <span>Calendario</span>
            </button>
            <button class="nav-btn" data-view="pagos">
                <i class="fas fa-credit-card"></i>
                <span>Pagos</span>
            </button>
            <button class="nav-btn" data-view="estadisticas">
                <i class="fas fa-chart-bar"></i>
                <span>Stats</span>
            </button>
            <button class="nav-btn" data-view="config">
                <i class="fas fa-cog"></i>
                <span>Config</span>
            </button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Vista Lista -->
            <section id="vista-lista" class="view-section active">
                <div class="section-header">
                    <h2>Mis Clases</h2>
                    <button class="btn-primary" id="btn-nueva-clase">
                        <i class="fas fa-plus"></i> Nueva Clase
                    </button>
                </div>
                
                <div class="filter-controls">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="buscar-clase" placeholder="Buscar por estudiante...">
                    </div>
                    
                    <div class="filter-group">
                        <label for="filtro-pago">Estado de Pago:</label>
                        <select id="filtro-pago">
                            <option value="">Todos</option>
                            <option value="pagado">Pagado</option>
                            <option value="pendiente">Pendiente</option>
                            <option value="vencido">Vencido</option>
                        </select>
                    </div>
                </div>

                <div id="lista-clases" class="clases-container">
                    <!-- Las clases se cargar√°n aqu√≠ din√°micamente -->
                </div>
            </section>

            <!-- Vista Calendario -->
            <section id="vista-calendario" class="view-section">
                <div class="calendar-header">
                    <button id="btn-calendario-anterior"><i class="fas fa-chevron-left"></i></button>
                    <h2 id="titulo-calendario"></h2>
                    <button id="btn-calendario-siguiente"><i class="fas fa-chevron-right"></i></button>
                </div>
                
                <!-- Toggle Vista Mes/Semana -->
                <div class="calendar-toggle">
                    <button class="toggle-btn active" id="toggle-mes">
                        <i class="fas fa-calendar-alt"></i> Mes
                    </button>
                    <button class="toggle-btn" id="toggle-semana">
                        <i class="fas fa-calendar-week"></i> Semana
                    </button>
                </div>
                
                <div id="calendario" class="calendario-grid">
                    <!-- El calendario se generar√° din√°micamente -->
                </div>
            </section>

            <!-- Vista Pagos -->
            <section id="vista-pagos" class="view-section">
                <div class="section-header">
                    <h2>Control de Pagos</h2>
                    <div class="pagos-stats">
                        <span class="stat-pill success">
                            <i class="fas fa-check"></i>
                            <span id="pagos-al-dia">0</span> al d√≠a
                        </span>
                        <span class="stat-pill warning">
                            <i class="fas fa-clock"></i>
                            <span id="pagos-pendientes-count">0</span> pendientes
                        </span>
                        <span class="stat-pill danger">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span id="pagos-vencidos">0</span> vencidos
                        </span>
                    </div>
                </div>

                <div class="pagos-filters">
                    <div class="filter-tabs">
                        <button class="filter-tab active" data-filter="todos">
                            <i class="fas fa-list"></i> Todos
                        </button>
                        <button class="filter-tab" data-filter="pendiente">
                            <i class="fas fa-clock"></i> Pendientes
                        </button>
                        <button class="filter-tab" data-filter="vencido">
                            <i class="fas fa-exclamation-triangle"></i> Vencidos
                        </button>
                        <button class="filter-tab" data-filter="pagado">
                            <i class="fas fa-check"></i> Pagados
                        </button>
                    </div>
                    
                    <div class="date-filter">
                        <label for="filtro-mes-pago">Mes:</label>
                        <select id="filtro-mes-pago">
                            <option value="">Todos los meses</option>
                            <option value="0">Enero</option>
                            <option value="1">Febrero</option>
                            <option value="2">Marzo</option>
                            <option value="3">Abril</option>
                            <option value="4">Mayo</option>
                            <option value="5">Junio</option>
                            <option value="6">Julio</option>
                            <option value="7">Agosto</option>
                            <option value="8">Septiembre</option>
                            <option value="9">Octubre</option>
                            <option value="10">Noviembre</option>
                            <option value="11">Diciembre</option>
                        </select>
                    </div>
                </div>

                <div id="lista-pagos" class="pagos-container">
                    <!-- Los pagos se cargar√°n aqu√≠ din√°micamente -->
                </div>
            </section>

            <!-- Vista Estad√≠sticas -->
            <section id="vista-estadisticas" class="view-section">
                <h2>Estad√≠sticas</h2>
                
                <div id="estadisticas-container" class="stats-container">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <i class="fas fa-euro-sign"></i>
                            <h3>Este Mes</h3>
                            <p class="stat-value" id="total-mes-stats">‚Ç¨0</p>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-users"></i>
                            <h3>Estudiantes</h3>
                            <p class="stat-value" id="total-estudiantes">0</p>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-clock"></i>
                            <h3>Total Clases</h3>
                            <p class="stat-value" id="total-clases-stats">0</p>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-chart-line"></i>
                            <h3>Promedio/Clase</h3>
                            <p class="stat-value" id="promedio-clase">‚Ç¨0</p>
                        </div>
                    </div>

                    <div class="pagos-resumen">
                        <h3>Resumen de Pagos</h3>
                        <div class="resumen-grid">
                            <div class="resumen-item success">
                                <i class="fas fa-check-circle"></i>
                                <div class="resumen-info">
                                    <span class="resumen-label">Pagadas</span>
                                    <span class="resumen-value" id="clases-pagadas">0</span>
                                </div>
                            </div>
                            <div class="resumen-item warning">
                                <i class="fas fa-clock"></i>
                                <div class="resumen-info">
                                    <span class="resumen-label">Pendientes</span>
                                    <span class="resumen-value" id="clases-pendientes">0</span>
                                </div>
                            </div>
                            <div class="resumen-item danger">
                                <i class="fas fa-exclamation-triangle"></i>
                                <div class="resumen-info">
                                    <span class="resumen-label">Vencidas</span>
                                    <span class="resumen-value" id="clases-vencidas">0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="stats-section">
                        <div class="pagos-stats-chart">
                            <h3>Distribuci√≥n de Pagos</h3>
                            <div class="pagos-chart">
                                <div class="chart-item">
                                    <div class="chart-bar">
                                        <div class="bar-fill success" id="bar-pagados"></div>
                                    </div>
                                    <span>Pagados</span>
                                    <strong id="porcentaje-pagados">0%</strong>
                                </div>
                                <div class="chart-item">
                                    <div class="chart-bar">
                                        <div class="bar-fill warning" id="bar-pendientes"></div>
                                    </div>
                                    <span>Pendientes</span>
                                    <strong id="porcentaje-pendientes">0%</strong>
                                </div>
                                <div class="chart-item">
                                    <div class="chart-bar">
                                        <div class="bar-fill danger" id="bar-vencidos"></div>
                                    </div>
                                    <span>Vencidos</span>
                                    <strong id="porcentaje-vencidos">0%</strong>
                                </div>
                            </div>
                        </div>

                        <div class="top-estudiantes">
                            <h3>Top Estudiantes</h3>
                            <div id="lista-top-estudiantes">
                                <!-- Se generar√° din√°micamente -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Vista Configuraci√≥n -->
            <section id="vista-config" class="view-section">
                <h2><i class="fas fa-cog"></i> Configuraci√≥n</h2>

                <!-- Sincronizaci√≥n GitHub -->
                <div class="config-section">
                    <div class="config-header">
                        <h3><i class="fab fa-github"></i> Sincronizaci√≥n con GitHub</h3>
                        <button class="btn-info btn-sm" onclick="verInfoSync()">
                            <i class="fas fa-info-circle"></i> Ver Estado
                        </button>
                    </div>
                    
                    <div class="config-card">
                        <div class="config-description">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <div>
                                <h4>Guardar en la nube</h4>
                                <p>Guarda una copia de seguridad de tus clases en GitHub Gist. Podr√°s acceder a tus datos desde cualquier dispositivo.</p>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="sincronizarConGitHub()">
                            <i class="fas fa-cloud-upload-alt"></i> Guardar en GitHub
                        </button>
                    </div>

                    <div class="config-card">
                        <div class="config-description">
                            <i class="fas fa-cloud-download-alt"></i>
                            <div>
                                <h4>Cargar desde la nube</h4>
                                <p>Restaura tus datos desde GitHub. <strong>Atenci√≥n:</strong> Esto reemplazar√° tus datos locales actuales.</p>
                            </div>
                        </div>
                        <button class="btn-secondary" onclick="cargarDesdeGitHub()">
                            <i class="fas fa-cloud-download-alt"></i> Cargar desde GitHub
                        </button>
                    </div>

                    <div class="config-info">
                        <i class="fas fa-lightbulb"></i>
                        <div>
                            <strong>Consejo:</strong> Guarda regularmente en GitHub para mantener tus datos seguros. Si usas m√∫ltiples dispositivos, carga los datos al inicio y guarda al finalizar.
                        </div>
                    </div>

                    <div class="config-info warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Configuraci√≥n requerida:</strong> Para usar esta funci√≥n, debes configurar tu token de GitHub y el ID del Gist en el archivo <code>github-sync.js</code>. Consulta la documentaci√≥n para m√°s detalles.
                        </div>
                    </div>
                </div>

                <!-- Copias de Seguridad Locales -->
                <div class="config-section">
                    <h3><i class="fas fa-download"></i> Copias de Seguridad Locales</h3>
                    
                    <div class="config-card">
                        <div class="config-description">
                            <i class="fas fa-file-export"></i>
                            <div>
                                <h4>Exportar datos</h4>
                                <p>Descarga un archivo JSON con todas tus clases para hacer una copia de seguridad local.</p>
                            </div>
                        </div>
                        <button class="btn-primary" onclick="exportarDatos()">
                            <i class="fas fa-file-export"></i> Exportar JSON
                        </button>
                    </div>

                    <div class="config-card">
                        <div class="config-description">
                            <i class="fas fa-file-import"></i>
                            <div>
                                <h4>Importar datos</h4>
                                <p>Restaura tus clases desde un archivo JSON previamente exportado.</p>
                            </div>
                        </div>
                        <button class="btn-secondary" onclick="document.getElementById('import-file').click()">
                            <i class="fas fa-file-import"></i> Importar JSON
                        </button>
                        <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importarDatos(event)">
                    </div>
                </div>

                <!-- Datos y Almacenamiento -->
                <div class="config-section">
                    <h3><i class="fas fa-database"></i> Datos y Almacenamiento</h3>
                    
                    <div class="config-stats-grid">
                        <div class="config-stat">
                            <i class="fas fa-list"></i>
                            <div class="config-stat-value" id="total-clases-config">0</div>
                            <div class="config-stat-label">Clases totales</div>
                        </div>
                        <div class="config-stat">
                            <i class="fas fa-database"></i>
                            <div class="config-stat-value" id="tama√±o-datos">0 KB</div>
                            <div class="config-stat-label">Espacio usado</div>
                        </div>
                        <div class="config-stat">
                            <i class="fas fa-clock"></i>
                            <div class="config-stat-value" id="ultima-actualizacion">-</div>
                            <div class="config-stat-label">√öltima actualizaci√≥n</div>
                        </div>
                    </div>

                    <div class="config-card danger">
                        <div class="config-description">
                            <i class="fas fa-trash-alt"></i>
                            <div>
                                <h4>Borrar todos los datos</h4>
                                <p><strong>‚ö†Ô∏è Acci√≥n irreversible:</strong> Esto eliminar√° permanentemente todas tus clases. Aseg√∫rate de hacer una copia de seguridad antes.</p>
                            </div>
                        </div>
                        <button class="btn-danger" onclick="borrarTodosDatos()">
                            <i class="fas fa-trash-alt"></i> Borrar Todo
                        </button>
                    </div>
                </div>

                <!-- Informaci√≥n de la Aplicaci√≥n -->
                <div class="config-section">
                    <h3><i class="fas fa-info-circle"></i> Acerca de</h3>
                    <div class="config-about">
                        <div class="about-item">
                            <strong>Versi√≥n:</strong> 2.0.0
                        </div>
                        <div class="about-item">
                            <strong>√öltima actualizaci√≥n:</strong> Noviembre 2025
                        </div>
                        <div class="about-item">
                            <strong>Caracter√≠sticas:</strong>
                            <ul>
                                <li>Gesti√≥n completa de clases y estudiantes</li>
                                <li>Control de pagos con estados (pagado, pendiente, vencido)</li>
                                <li>Calendario mensual y semanal</li>
                                <li>Estad√≠sticas detalladas</li>
                                <li>Sincronizaci√≥n en la nube con GitHub</li>
                                <li>Responsive design para m√≥viles</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Modal para Nueva/Editar Clase -->
        <div id="modal-clase" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-titulo">Nueva Clase</h3>
                    <button class="btn-close" id="btn-cerrar-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <form id="form-clase" class="form-clase">
                    <div class="form-group">
                        <label for="estudiante">Estudiante</label>
                        <input type="text" id="estudiante" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fecha">Fecha</label>
                            <input type="date" id="fecha" required>
                        </div>
                        <div class="form-group">
                            <label for="hora">Hora</label>
                            <input type="time" id="hora" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="precio">Precio (‚Ç¨)</label>
                            <input type="number" id="precio" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="estado-pago">Estado de Pago</label>
                            <select id="estado-pago">
                                <option value="pendiente">Pendiente</option>
                                <option value="pagado">Pagado</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group" id="grupo-fecha-pago" style="display: none;">
                        <label for="fecha-pago">Fecha de Pago</label>
                        <input type="date" id="fecha-pago">
                    </div>
                    
                    <div class="form-group">
                        <label for="observaciones">Observaciones</label>
                        <textarea id="observaciones" rows="3" placeholder="Notas adicionales..."></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="btn-cancelar">Cancelar</button>
                        <button type="submit" class="btn-primary" id="btn-guardar">Guardar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal de Pago -->
        <div id="modal-pago" class="modal">
            <div class="modal-content modal-small">
                <div class="modal-header">
                    <h3>Marcar como Pagado</h3>
                    <button class="btn-close" id="btn-cerrar-modal-pago">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="modal-body">
                    <div class="pago-info">
                        <h4 id="pago-estudiante">Estudiante</h4>
                        <p id="pago-fecha-clase">Fecha de clase</p>
                        <p id="pago-importe">Importe</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="fecha-pago-modal">Fecha de Pago</label>
                        <input type="date" id="fecha-pago-modal" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="metodo-pago">M√©todo de Pago</label>
                        <select id="metodo-pago">
                            <option value="efectivo">Efectivo</option>
                            <option value="transferencia">Transferencia</option>
                            <option value="tarjeta">Tarjeta</option>
                            <option value="bizum">Bizum</option>
                            <option value="otro">Otro</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="notas-pago">Notas</label>
                        <textarea id="notas-pago" rows="2" placeholder="Notas adicionales sobre el pago..."></textarea>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="btn-cancelar-pago">Cancelar</button>
                    <button type="button" class="btn-primary" id="btn-confirmar-pago">Confirmar Pago</button>
                </div>
            </div>
        </div>

        <!-- Modal de Confirmaci√≥n -->
        <div id="modal-confirmacion" class="modal">
            <div class="modal-content modal-small">
                <h3>¬øEliminar clase?</h3>
                <p>Esta acci√≥n no se puede deshacer.</p>
                <div class="form-actions">
                    <button class="btn-secondary" id="btn-cancelar-eliminar">Cancelar</button>
                    <button class="btn-danger" id="btn-confirmar-eliminar">Eliminar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast para notificaciones -->
    <div id="toast" class="toast">
        <span id="toast-message"></span>
    </div>

    <!-- JavaScript -->
    <script>
        // Verificaci√≥n b√°sica para debugging en GitHub Pages
        window.addEventListener('error', function(e) {
            console.error('Error global capturado:', e.error);
        });
        
        // Log b√°sico para verificar carga
        console.log('HTML cargado correctamente');
        console.log('URL actual:', window.location.href);
        console.log('localStorage disponible:', typeof(Storage) !== "undefined");
        
        // Detectar si estamos en GitHub Pages
        if (window.location.hostname.includes('github.io')) {
            console.log('üåê Ejecutando en GitHub Pages');
        }
    </script>
    <script src="app.js"></script>
    <script src="github-sync.js"></script>
</body>
</html>
